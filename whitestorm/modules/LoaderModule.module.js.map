{"version":3,"file":"LoaderModule.module.js","sources":["../src/modules/extra/node_modules/minivents/dist/minivents.commonjs.js","../src/modules/extra/LoaderModule.js"],"sourcesContent":["module.exports = function Events(target){\n  var events = {}, empty = [];\n  target = target || this\n  /**\n   *  On: listen to events\n   */\n  target.on = function(type, func, ctx){\n    (events[type] = events[type] || []).push([func, ctx])\n  }\n  /**\n   *  Off: stop listening to event / specific callback\n   */\n  target.off = function(type, func){\n    type || (events = {})\n    var list = events[type] || empty,\n        i = list.length = func ? list.length : 0;\n    while(i--) func == list[i][0] && list.splice(i,1)\n  }\n  /** \n   * Emit: send event, callbacks will be triggered\n   */\n  target.emit = function(type){\n    var e = events[type] || empty, list = e.length > 0 ? e.slice(0, e.length) : e, i=0, j;\n    while(j=list[i++]) j[0].apply(j[1], empty.slice.call(arguments, 1))\n  };\n};","import Events from 'minivents';\n\nexport class LoaderModule extends Events {\n  constructor(...expecting) {\n    super();\n\n    this.promises = {};\n\n    this.expecting = expecting;\n    this.resolved = [];\n  }\n\n  expect(key) {\n    this.expecting.push(key);\n  }\n\n  resolve(key) {\n    if (this.expecting.includes(key)) {\n      this.expecting = this.expecting.filter(item => item !== key);\n      this.resolved.push(key);\n    }\n\n    this.emit('step', key);\n\n    if (this.getProgress() === 1) {\n      this.emit('complete');\n    }\n\n    return this;\n  }\n\n  promise(key, promise) {\n    promise.then(() => this.resolve(key));\n\n    this.promises[key] = promise;\n    this.expect(key);\n\n    return promise;\n  }\n\n  getProgress() {\n    const el = this.expecting.length;\n    const rl = this.resolved.length;\n\n    return rl / (el + rl);\n  }\n}\n"],"names":["LoaderModule","promises","expecting","resolved","key","push","includes","filter","item","emit","getProgress","promise","then","resolve","expect","el","length","rl","Events"],"mappings":";AAAA,sBAAc,GAAG,SAAS,MAAM,CAAC,MAAM,CAAC;EACtC,IAAI,MAAM,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE,CAAC;EAC5B,MAAM,GAAG,MAAM,IAAI,KAAI;;;;EAIvB,MAAM,CAAC,EAAE,GAAG,SAAS,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC;IACnC,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,GAAG,CAAC,EAAC;IACtD;;;;EAID,MAAM,CAAC,GAAG,GAAG,SAAS,IAAI,EAAE,IAAI,CAAC;IAC/B,IAAI,KAAK,MAAM,GAAG,EAAE,EAAC;IACrB,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,KAAK;QAC5B,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7C,MAAM,CAAC,EAAE,EAAE,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAC;IAClD;;;;EAID,MAAM,CAAC,IAAI,GAAG,SAAS,IAAI,CAAC;IAC1B,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,KAAK,EAAE,IAAI,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IACtF,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,EAAC;GACpE,CAAC;CACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICvBYA;;;0BACe;;;;;UAGnBC,QAAL,GAAgB,EAAhB;;sCAHaC,SAAW;eAAA;;;UAKnBA,SAAL,GAAiBA,SAAjB;UACKC,QAAL,GAAgB,EAAhB;;;;;;2BAGKC,KAAK;WACLF,SAAL,CAAeG,IAAf,CAAoBD,GAApB;;;;4BAGMA,KAAK;UACP,KAAKF,SAAL,CAAeI,QAAf,CAAwBF,GAAxB,CAAJ,EAAkC;aAC3BF,SAAL,GAAiB,KAAKA,SAAL,CAAeK,MAAf,CAAsB;iBAAQC,SAASJ,GAAjB;SAAtB,CAAjB;aACKD,QAAL,CAAcE,IAAd,CAAmBD,GAAnB;;;WAGGK,IAAL,CAAU,MAAV,EAAkBL,GAAlB;;UAEI,KAAKM,WAAL,OAAuB,CAA3B,EAA8B;aACvBD,IAAL,CAAU,UAAV;;;aAGK,IAAP;;;;4BAGML,KAAKO,UAAS;;;eACZC,IAAR,CAAa;eAAM,OAAKC,OAAL,CAAaT,GAAb,CAAN;OAAb;;WAEKH,QAAL,CAAcG,GAAd,IAAqBO,QAArB;WACKG,MAAL,CAAYV,GAAZ;;aAEOO,QAAP;;;;kCAGY;UACNI,KAAK,KAAKb,SAAL,CAAec,MAA1B;UACMC,KAAK,KAAKd,QAAL,CAAca,MAAzB;;aAEOC,MAAMF,KAAKE,EAAX,CAAP;;;;EA1C8BC;;;;"}